<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DAW JSON Link: Automated Code Generation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="json_link_logo_55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DAW JSON Link
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Automated Code Generation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md5"></a>
This is currently out of date</h1>
<p>What we need to begin We need the <a href="https://github.com/beached/json_to_cpp">json_to_cpp</a> tool.</p>
<p>To build it </p><div class="fragment"><div class="line">git clone https://github.com/beached/json_to_cpp.git</div>
<div class="line">cd json_to_cpp</div>
<div class="line">mkdir build</div>
<div class="line">cd build</div>
<div class="line">cmake ..</div>
<div class="line">cmake --build . </div>
</div><!-- fragment --><p>Now we will have an executable called json_to_cpp/json_to_cpp.exe that will allow us to convert a json file to C++ structures along with the descript_json_class/to_json_data methods.</p>
<p>For example, let's use <a href="../test_data/cookbook_class2.json">cookbook_class2.json</a> from the <a class="el" href="md___users_dwright__dropbox_github_daw_json_link_cookbook_class.html">class.md</a> cookbook</p>
<div class="fragment"><div class="line">json_to_cpp --infile=cookbook_class2.json</div>
</div><!-- fragment --><p>The program will output the following C++ code </p><div class="fragment"><div class="line"> {c++}</div>
<div class="line">#include &lt;tuple&gt;</div>
<div class="line">#include &lt;cstdint&gt;</div>
<div class="line">#include &lt;string&gt;</div>
<div class="line">#include &lt;daw/json/daw_json_link.h&gt;</div>
<div class="line"> </div>
<div class="line">struct a_t {</div>
<div class="line">  std::string member0;</div>
<div class="line">  int64_t member1;</div>
<div class="line">  bool member2;</div>
<div class="line">};  // a_t</div>
<div class="line"> </div>
<div class="line">namespace symbols_a_t {</div>
<div class="line">  static constexpr char const member0[] = &quot;member0&quot;;</div>
<div class="line">  static constexpr char const member1[] = &quot;member1&quot;;</div>
<div class="line">  static constexpr char const member2[] = &quot;member2&quot;;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">inline auto json_data_contract_for( a_t ) {</div>
<div class="line">  using namespace daw::json;</div>
<div class="line">  return daw::json::json_member_list&lt;</div>
<div class="line">    json_string&lt;symbols_a_t::member0&gt;</div>
<div class="line">    ,json_number&lt;symbols_a_t::member1, int64_t&gt;</div>
<div class="line">    ,json_bool&lt;symbols_a_t::member2&gt;</div>
<div class="line">  &gt;{};</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">inline auto to_json_data( a_t const &amp; value ) {</div>
<div class="line">  return std::forward_as_tuple( value.member0, value.member1, value.member2 );</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">struct root_object_t {</div>
<div class="line">  a_t a;</div>
<div class="line">  int64_t b;</div>
<div class="line">};  // root_object_t</div>
<div class="line"> </div>
<div class="line">namespace symbols_root_object_t {</div>
<div class="line">  static constexpr char const a[] = &quot;a&quot;;</div>
<div class="line">  static constexpr char const b[] = &quot;b&quot;;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">inline auto json_data_contract_for( root_object_t ) {</div>
<div class="line">  using namespace daw::json;</div>
<div class="line">  return daw::json::json_member_list&lt;</div>
<div class="line">    json_class&lt;symbols_root_object_t::a, a_t&gt;</div>
<div class="line">    ,json_number&lt;symbols_root_object_t::b, int64_t&gt;</div>
<div class="line">  &gt;{};</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">inline auto to_json_data( root_object_t const &amp; value ) {</div>
<div class="line">  return std::forward_as_tuple( value.a, value.b );</div>
<div class="line">}</div>
</div><!-- fragment --><p>As you can see it is pretty close to the types specified, except in this case for integrals it defaults to intmax_t as it cannot know that it was an unsigned.</p>
<p>We can make it prettier as the default will use root_object_t as the type of the root class and the other objects are the name of their members suffixed with <code>_t</code></p>
<p>Let's give the root object a name </p><div class="fragment"><div class="line">json_to_cpp --root_object=MyClass2 --infile=cookbook_class2.json</div>
</div><!-- fragment --><p>The tool was used to generate the citm, twitter, and canada json examples as the json data is large.</p>
<p>One other option is we can specify members that are kv class pairs where the keys are the member names and values the associated values. This cleans up the generated code substantially in many cases. The path is specified as <code>member.submember.subsubmember...</code> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
