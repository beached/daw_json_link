<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DAW JSON Link: Key Values</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DAW JSON Link
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Key Values </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Dictionaries and Maps are not directly represented in JSON. There are several ways that they are commonly encoded.</p>
<h1><a class="anchor" id="autotoc_md28"></a>
As Class</h1>
<p>Keys are stored as member names and Values as their value. This is very common, but limits the Key type to strings in JSON. However, numbers and other literals are able to be encoded as strings.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;kv&quot;: {</div>
<div class="line">    &quot;key0&quot;: 353434,</div>
<div class="line">    &quot;key1&quot;: 314159</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p>Too see a working example using this code, refer to <a href="https://raw.githubusercontent.com/beached/daw_json_link/release/tests/src/cookbook_kv1_test.cpp">cookbook_kv1_test.cpp</a> Below the JSON object is mapped to a <code>std::unordered_map&lt;std::string, int&gt;</code></p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">struct MyKeyValue {</div>
<div class="line">  std::map&lt;std::string, int&gt; kv;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">namespace daw::json {</div>
<div class="line">  template&lt;&gt;</div>
<div class="line">  struct json_data_contract&lt;MyKeyValue1&gt; {</div>
<div class="line">    using type = json_member_list&lt;</div>
<div class="line">      json_key_value&lt;&quot;kv&quot;, std::unordered_map&lt;std::string, int&gt;, int&gt;</div>
<div class="line">    &gt;;</div>
<div class="line"> </div>
<div class="line">    static inline auto</div>
<div class="line">    to_json_data( MyKeyValue1 const &amp;value ) {</div>
<div class="line">      return std::forward_as_tuple( value.kv );</div>
<div class="line">    }</div>
<div class="line">  };</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md29"></a>
As Array</h1>
<p>Key/Values are stored as JSON objects in an array. Generally the key member's name is <code>"key"</code> and the value members name is <code>"value"</code></p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;kv&quot;: [</div>
<div class="line">    {</div>
<div class="line">      &quot;key&quot;: 0,</div>
<div class="line">      &quot;value&quot;: &quot;test_001&quot;</div>
<div class="line">    },</div>
<div class="line">    {</div>
<div class="line">      &quot;key&quot;: 1,</div>
<div class="line">      &quot;value&quot;: &quot;test_002&quot;</div>
<div class="line">    }</div>
<div class="line">  ]</div>
<div class="line">}</div>
</div><!-- fragment --><p>The above JSON document an array member named <code>"kv"</code> whose element is an object with int keys, named <code>"key"</code> and string values named <code>"value"</code>.</p>
<p>Below it is mapped to a <code>std::unorderd_map&lt;intmax_t, std::string&gt;</code> Too see a working example using this code, refer to <a href="https://raw.githubusercontent.com/beached/daw_json_link/release/tests/src/cookbook_kv2_test.cpp">cookbook_kv2_test.cpp</a></p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">struct MyKeyValue2 {</div>
<div class="line">  std::unordered_map&lt;intmax_t, std::string&gt; kv;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">namespace daw::json {</div>
<div class="line">  template&lt;&gt;</div>
<div class="line">  struct json_data_contract&lt;MyKeyValue2&gt; {</div>
<div class="line">    using type = json_member_list&lt;</div>
<div class="line">      json_key_value_array&lt;&quot;kv&quot;, std::unordered_map&lt;intmax_t, std::string&gt;&gt;&gt;;</div>
<div class="line"> </div>
<div class="line">    static inline auto to_json_data( MyKeyValue2 const &amp;v ) {</div>
<div class="line">      return std::forward_as_tuple( v.kv );</div>
<div class="line">    }</div>
<div class="line">  };</div>
<div class="line">} </div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md30"></a>
MultiMap</h1>
<p>It is possible to parse/serialize Multimap likes types. A JSON document, such as</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;kv&quot;: {</div>
<div class="line">    &quot;firstName&quot;: &quot;Jane&quot;,</div>
<div class="line">    &quot;firstName&quot;: &quot;John&quot;</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p>When mapped to a C++ class, it will parse the first <code>"firstName"</code> it finds, skipping the rest. To parse this as a <code>json_key_value</code>, the following code will work if it is a submember of the root, or subsequent submember's.</p>
<p>Too see a working example using this code, refer to <a href="https://raw.githubusercontent.com/beached/daw_json_link/release/tests/src/cookbook_kv3_test.cpp">cookbook_kv3_test.cpp</a></p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">struct MyKeyValue3 {</div>
<div class="line">  std::multimap&lt;std::string, std::string&gt; kv;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">namespace daw::json {</div>
<div class="line">  template&lt;&gt;</div>
<div class="line">  struct json_data_contract&lt;MyKeyValue3&gt; {</div>
<div class="line">    using type = json_member_list&lt;</div>
<div class="line">      json_key_value&lt;</div>
<div class="line">        &quot;kv&quot;, </div>
<div class="line">        std::multimap&lt;std::string, std::string&gt;, </div>
<div class="line">        std::string&gt;</div>
<div class="line">      &gt;;</div>
<div class="line"> </div>
<div class="line">    static inline auto to_json_data( MyKeyValue3 const &amp;v ) {</div>
<div class="line">      return std::forward_as_tuple( v.kv );</div>
<div class="line">    }</div>
<div class="line">  };</div>
<div class="line">} </div>
</div><!-- fragment --><p>Alternatively, a type like <code>std::vector&lt;std::pair&lt;Key, Value&gt;&gt;</code> would work in the above example too.</p>
<p>If the root object has duplicate keys, one needs to use the <code>json_value</code> interface and then use <code>from_json</code> to parse it.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;firstName&quot;: &quot;Jane&quot;,</div>
<div class="line">  &quot;firstName&quot;: &quot;John&quot;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Too see a working example using this code, refer to <a href="https://raw.githubusercontent.com/beached/daw_json_link/release/tests/src/cookbook_kv4_test.cpp">cookbook_kv4_test.cpp</a></p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">std::string_view json_data = ...;</div>
<div class="line">auto val = daw::json::json_value( json_data );</div>
<div class="line">std::multimap&lt;std::string, std::string kv = </div>
<div class="line">  daw::json::from_json&lt;</div>
<div class="line">    json_key_value&lt;</div>
<div class="line">      no_name, </div>
<div class="line">      std::multimap&lt;std::string, std::string&gt;,</div>
<div class="line">      std::string</div>
<div class="line">    &gt;</div>
<div class="line">  &gt;( val );</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
